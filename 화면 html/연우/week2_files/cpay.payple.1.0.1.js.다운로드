var screen_width=$(window).width(),screen_height=window.innerHeight&&window.innerHeight<$(window).height()?window.innerHeight:$(window).height(),deviceAgent=navigator.userAgent.toLowerCase(),isMobile=!1;(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(isMobile=!0);var cpay_ifr_width=450,cpay_ifr_height=screen_height,cpay_ifr_windowHeight=0,cpay_ifr_top=0,http_referer=$(location).attr("href"),cPayData="",isResultSent=!1,cpay_val_to_int=function(e){return result=e.toString(),result=result.replace(/([^0-9\.]+)/g,""),result=parseInt(result),result},CreateCpayLayer=function(e){var a=cpay_ifr_width+"px",t="100%";"card"==e.PCD_PAY_TYPE&&"AUTH"!=e.PCD_PAY_WORK&&"01"!=e.PCD_CARD_VER&&(cpay_ifr_width=692,cpay_ifr_top=(screen_height-(cpay_ifr_height=500))/2,a="692px",t="550px");e="";e+='<div id="layer_cpay" name="layer_cpay" style="position:absolute;z-index:16777270;top:0;left:0;margin-top:0px;margin-left:0px;">',e+='<div id="cpay_loader" style="position: fixed; left: 0px; top: 0px; width: 100%; height: 100%; z-index: 16777271; background: url(\'https://cpay.payple.kr/img/spin.gif\') 50% 40% no-repeat rgb(249,249,249); opacity: 0.5;"></div>',e+='<iframe id="cpay_ifr" name="cpay_ifr" style="display:none;width:'+a+"; height:"+t+"; top:"+cpay_ifr_top+'; position:absolute; z-index:16777271; background:white;" frameborder="0" scrolling="auto"></iframe>',e+="</div>",$(e).appendTo("body")},PaypleCpayPopup=function(e){isResultSent=!1,"02"!=e.PCD_CARD_VER&&(cpay_ifr_width=450),isMobile||CreateCpayLayer(e),cPayData=e;var a=$("<form></form>");a.attr("id","CpayForm"),a.attr("method","post"),a.attr("action",e.PCD_PAY_URL);var t="";if(e.PCD_HTTP_REFERER=http_referer,""==e.PCD_PAY_WORK||null==e.PCD_PAY_WORK?e.PCD_PAY_WORK="PAY":(e.PCD_PAY_WORK=e.PCD_PAY_WORK.toString().toUpperCase(),"AUTH"!=e.PCD_PAY_WORK&&"PAY"!=e.PCD_PAY_WORK&&"CERT"!=e.PCD_PAY_WORK&&(e.PCD_PAY_WORK="PAY")),""==e.PCD_PAY_TYPE||null==e.PCD_PAY_TYPE)return alert("결제수단이 존재하지 않습니다."),$("#layer_cpay").remove(),!1;if("card"!=e.PCD_PAY_TYPE&&"CARD"!=e.PCD_PAY_TYPE&&"transfer"!=e.PCD_PAY_TYPE&&"TRANSFER"!=e.PCD_PAY_TYPE)return alert("결제수단이 올바르지 않습니다. 고객센터로 문의해주시면 친절하게 안내해드립니다."),$("#layer_cpay").remove(),!1;if("CARD"!=e.PCD_PAY_TYPE&&"TRANSFER"!=e.PCD_PAY_TYPE||(e.PCD_PAY_TYPE=e.PCD_PAY_TYPE.toLowerCase()),"CERT"==e.PCD_PAY_WORK||"PAY"==e.PCD_PAY_WORK){if(null==e.PCD_PAY_TOTAL||""==e.PCD_PAY_TOTAL)return alert("결제금액이 존재하지 않습니다."),$("#layer_cpay").remove(),!1;if(isNaN(e.PCD_PAY_TOTAL))return alert("결제금액 형식이 바르지 않습니다."),$("#layer_cpay").remove(),!1;var i=cpay_val_to_int(e.PCD_PAY_TOTAL);if("card"==e.PCD_PAY_TYPE){if(i<100)return alert("결제금액은 100원 이상 이어야 합니다."),$("#layer_cpay").remove(),!1}else if(i<200)return alert("결제금액은 200원 이상 이어야 합니다."),$("#layer_cpay").remove(),!1;if(e.PCD_PAY_TOTAL=i,"string"!=typeof e.PCD_PAY_GOODS)return alert("결제상품명 형식이 바르지 않습니다."),$("#layer_cpay").remove(),!1;if(null==e.PCD_PAY_GOODS||""==e.PCD_PAY_GOODS.trim())return alert("결제상품명이 존재하지 않습니다."),$("#layer_cpay").remove(),!1;if(e.PCD_PAY_GOODS=e.PCD_PAY_GOODS.trim(),e.PCD_PAY_TAXTOTAL){i=e.PCD_PAY_TAXTOTAL.toString().trim();if(isNaN(i)||9<i.length)return alert("복합과세 지정부가세 형식이 바르지 않습니다."),$("#layer_cpay").remove(),!1}}if(e.PCD_PAYER_HP&&15<e.PCD_PAYER_HP.replace(/([^0-9\.]+)/g,"").length)return alert("결제자 휴대전화번호는 15자 이하이어야 합니다."),$("#layer_cpay").remove(),!1;if($.each(e,function(e,a){"PCD_PAY_GOODS"==e&&(a=a.replace("&","&amp;").replace("#","&#35;").replace("<","&lt;").replace(">","&gt;").replace(/"/g,"&quot;").replace("\\","&#39;").replace("%","&#37;").replace("(","&#40;").replace(")","&#41;").replace("+","&#43;").replace("/","&#47;").replace(".","&#46;")),t+='<input type="hidden" name="'+e+'" value="'+a+'">'}),a.append(t),e.PCD_RST_URL||(e.PCD_RST_URL=""),-1!=e.PCD_RST_URL.indexOf("http://")||-1!=e.PCD_RST_URL.indexOf("https://"))a.appendTo($(document.body)).submit();else if(isMobile){if(null==window.open("","cpayWinOpen","width:450px,height:100%,toolbars=no,menubars=no,status=no,resizable=no,location=no"))return alert(" 팝업이 차단되어 결제를 진행할 수 없습니다. \r\n 폰 설정에서 팝업차단을 풀어주세요. "),!1;a.attr("target","cpayWinOpen"),a.appendTo($(document.body)),a.submit()}else a.attr("target","cpay_ifr"),a.appendTo($(document.body)).submit(),layer_ifr_resize();a.remove()},layer_ifr_resize=function(){var e=$(window).width(),a=$(document).height(),t=e/2-cpay_ifr_width/2,i=cpay_ifr_top;$("#layer_cpay").css({position:"fixed","z-index":16777270,top:0,left:0,width:e,height:a,display:"block",background:"url(https://cpay.payple.kr/img/background.png)","background-repeat":"no-repeat","background-size":"100% 100%",fliter:"alpha(opacity=50)"}),$("#cpay_ifr").css({left:t+"px",top:i,height:cpay_ifr_height})},MainBodyResize=function(e){$("body").css({height:e+200}),isMobile||($("#layer_cpay").css({left:"0px",width:$(window).width(),height:e,display:"block",background:"url(https://cpay.payple.kr/img/background.png)","background-repeat":"no-repeat","background-size":"100% 100%",fliter:"alpha(opacity=50)"}),$("#cpay_ifr").css({height:e}))},PaypleCpayAuthCheck=function(a){if(a.PCD_BUYER_NAME="",null!=a.PCD_PAYER_NAME&&(a.PCD_BUYER_NAME=a.PCD_PAYER_NAME),a.clientKey&&""!=a.clientKey){a.pSessionTime="",$.ajax({type:"GET",url:"https://hub.payple.kr/ipinfo",dataType:"json",async:!1,success:function(e){a.pSessionTime=e.date}});var t=a.clientKey.split("_"),i=2===t.length?t[0]:"",r="git"===i?"http://":"https://";let e="";e=""===i?"":"test"===i?"demo":"git"===i?"git.":i+"-",a.PCD_PAY_URL=r+e+"cpay.payple.kr/index.php?ACT_=PAYM&CPAYVER="+a.pSessionTime,PaypleCpayPopup(a)}else if(a.PCD_AUTH_KEY&&""!=a.PCD_AUTH_KEY)PaypleCpayPopup(a);else{if(!(a.payple_auth_file&&""!=a.payple_auth_file||a.PCD_AUTH_URL&&""!=a.PCD_AUTH_URL||a.payple_dir_path&&""!=a.payple_dir_path))return alert("파트너 인증은 필수입니다."),!1;var e=new FormData,t="",i=a.payple_dir_path&&""!=a.payple_dir_path?a.payple_dir_path:"",r=a.payple_auth_file&&""!=a.payple_auth_file?a.payple_auth_file:"payple_payAuth.html";e.append("payple_dir_path",i),t=a.PCD_CST_ID&&""!=a.PCD_CST_ID?(e.append("cst_id",a.PCD_CST_ID),e.append("custKey",a.PCD_CUST_KEY),a.PCD_AUTH_URL):-1==r.indexOf("/")||0!=r.indexOf("/")&&0!=r.indexOf("http://")&&0!=r.indexOf("https://")?i+"/cPayPayple/"+r:r,$.ajax({type:"POST",cache:!1,processData:!1,url:t,contentType:!1,async:!1,dataType:"json",data:e,crossDomain:!0,success:function(e){if("success"!=e.result)return alert(e.result_msg),!1;a.PCD_CST_ID=e.cst_id,a.PCD_CUST_KEY=e.custKey,a.PCD_AUTH_KEY=e.AuthKey,a.PCD_PAY_URL=e.return_url,PaypleCpayPopup(a)},error:function(e,a,t){alert(e.statusText+",  "+a+",   "+t)}})}},PaypleLinkCpayAuthCheck=function(){var e=new FormData,a=$("#CpayForm")[0];$.ajax({type:"POST",cache:!1,processData:!1,url:"/php/link/payAuth.php",contentType:!1,async:!1,dataType:"json",data:e,success:function(e){if("success"!=e.result)return alert(e.result_msg),!1;a.PCD_PAY_URL=e.return_url,PaypleCpayPopup(a)},error:function(e,a,t){alert(e.statusText+",  "+a+",   "+t)}})},PaypleCpayPayResult=function(e,a){var t;e.callbackFunction&&delete e.callbackFunction,isResultSent||(isResultSent=!0,a?(MainBodyAction("close"),a(e)):(a=e.PCD_RST_URL,t="",$.each(e,function(e,a){t+='<input type="hidden" name="'+e+'" value="'+a+'">'}),$('<form name="PaypleCpayResultForm" action="'+a+'" method="post">'+t+"</form>").appendTo($(document.body)).submit()))},MainBodyAction=function(e){"close"==e&&($("#cpay_ifr").remove(),$("#layer_cpay").remove())};$(document).ready(function(e){var a="";void 0!==window.addEventListener?a="message":void 0!==window.attachEvent&&(a="onmessage"),""!=a&&window.addEventListener("message",function(e){var t,a=e.data.type,e=e.data.data;"close"==a?(MainBodyAction("close"),(t=cPayData).PCD_PAY_RST="close",t.PCD_PAY_MSG="결제를 종료하였습니다.",delete t.PCD_BUYER_NAME,t&&0!==Object.keys(t).length&&$.each(t,function(e,a){"number"==typeof a&&(t[e]=a.toString())}),PaypleCpayPayResult(t,t.callbackFunction)):"pay_result"==a?PaypleCpayPayResult(e,(t=cPayData).callbackFunction):"resize"==a&&(cpay_ifr_top=(screen_height-(cpay_ifr_height=(cpay_ifr_windowHeight=e)<screen_height?cpay_ifr_windowHeight:screen_height))/2,$("#cpay_ifr").css({top:cpay_ifr_top,height:cpay_ifr_height,display:""}),$("#cpay_loader").css("display","none"))})});